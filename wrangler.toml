name = "senti-bot-worker"
main = "src/index.js"
compatibility_date = "2024-09-25"
account_id = "2cf6e316af8623546c95c0354bc3aa00"

# --- CRONs: heartbeat кожні 15 хв + автоеволюція щогодини ---
[triggers]
crons = ["*/15 * * * *", "0 * * * *"]

# --- Публічні змінні середовища (НЕ секрети) ---
[vars]
SERVICE_HOST = "senti-bot-worker.restsva.workers.dev"
DRIVE_FOLDER_ID = "root"
TELEGRAM_ADMIN_ID = "784869835"
DEPLOY_ID = "local-dev"
WEBHOOK_SECRET = "senti1984"
TG_WEBHOOK_SECRET = "senti1984"

# ДІАГНОСТИЧНІ ТЕГИ: "on" — показує [via ...], "off" — ховає
DIAG_TAGS = "on"

# Порядок спроб моделей (fallback зліва направо)
# Додано резервний провайдер "free:" (будь-який OpenAI-compatible endpoint).
MODEL_ORDER = "gemini:gemini-2.5-flash, cf:@cf/meta/llama-3.1-8b-instruct, openrouter:deepseek/deepseek-chat, free:gpt-3.5-turbo"

# Необов'язкові дефолти для провайдерів (можеш змінити при потребі)
GEMINI_MODEL = "gemini-2.5-flash"
CF_MODEL     = "@cf/meta/llama-3.1-8b-instruct"

# --- OpenAI-compatible (free) провайдер ---
# Бекенд сумісний з OpenAI API. Якщо ці змінні не задані — провайдер буде пропущено.
# FREE_API_KEY має бути доданий у Dashboard → Secrets (СЕКРЕТ, не в toml).
FREE_API_BASE_URL = "https://api.deepseek.com"
FREE_API_MODEL    = "gpt-3.5-turbo"
FREE_API_PATH     = "/v1/chat/completions"

# --- KV bindings ---
[[kv_namespaces]]
binding = "DEDUP_KV"
id = "20d81d7b68fa4ac6b9913e2fbd3465d5"

[[kv_namespaces]]
binding = "OAUTH_KV"
id = "e2a8d3941b4e41728318781e739a4d47"

[[kv_namespaces]]
binding = "STATE_KV"
id = "7b32e2d1f60846ddb1c653eb52180bf7"

[[kv_namespaces]]
binding = "TODO_KV"
id = "497eac980691495ea2a0bc8611892d65"

[[kv_namespaces]]
binding = "USER_OAUTH_KV"
id = "470d4f5c164a4a828c569eb9a52a5133"

[[kv_namespaces]]
binding = "CHECKLIST_KV"
id = "497eac980691495ea2a0bc8611892d65"